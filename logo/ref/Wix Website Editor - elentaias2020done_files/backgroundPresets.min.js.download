define("backgroundPresets",["tslib","lodash","util","react","prop-types","create-react-class","constants","baseUI","core","react-dom","color"],(function(e,t,i,a,r,s,n,o,l,d,u){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1030)}({0:function(t,i){t.exports=e},1:function(e,i){e.exports=t},1030:function(e,t,i){var a,r;a=[i,t,i(0),i(1031)],void 0===(r=function(e,t,i,a){"use strict";return(a=i.__importDefault(a)).default}.apply(t,a))||(e.exports=r)},1031:function(e,t,i){var a,r;a=[i,t,i(0),i(3),i(5),i(4),i(1),i(11),i(2),i(97),i(6),i(1032),i(9)],void 0===(r=function(e,t,i,a,r,s,n,o,l,d,u,c,p){"use strict";function m(){return a.default.createElement("div",{className:"bg-preset-list-section section-wrapper"},a.default.createElement("div",{className:"section-header"},a.default.createElement("div",{className:"title-line"},a.default.createElement("div",{className:"title"},this.props.title),a.default.createElement(p.infoIcon,{key:"infoIcon",text:this.props.infoTooltip,className:"info-icon"}))),a.default.createElement("ul",{className:"preset-list-section-list ".concat("columns-".concat(this.props.columns||1))},n.default.map(this.getPresetData(),(e,t)=>a.default.createElement("li",{key:"preset".concat(t),onClick:()=>{this.selectPreset(e,"presetBackgrounds",t)},className:"preset-list-item"},a.default.createElement(p.tooltip,{value:this.getMediaPreviewComp(e),alignment:"right",styleType:u.default.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,delay:"300",width:"294px",noArrow:!0},a.default.createElement("div",{style:this.getThumbBackdropStyle(e),className:"preset-list-preset"},a.default.createElement("div",{style:this.getThumbStyle(e),className:"preset-list-preset-content"}),this.isMediaVideo(e)?a.default.createElement("div",{style:this.getOverlayStyle(e),key:"preset-list-preset-overlay",className:"preset-list-preset-overlay"}):null,this.isMediaVideo(e)?a.default.createElement("div",{key:"bgVideoIndicator",className:"preset-list-preset-video-controls"},a.default.createElement(p.symbol,{name:"bgVideoIndicator"})):null,e.thumbnail&&e.thumbnail.title?a.default.createElement("div",{key:"preset-title",className:"preset-title"},l.translate(e.thumbnail.title)):null))))))}a=i.__importDefault(a),r=i.__importDefault(r),s=i.__importDefault(s),n=i.__importDefault(n),o=i.__importStar(o),l=i.__importStar(l),d=i.__importDefault(d),u=i.__importDefault(u),c=i.__importDefault(c),p=i.__importStar(p);const{url:h,serviceTopology:f,imageTransform:g,backgroundUtils:y}=l,{getColorValue:v}=y,{fittingTypes:b,alignTypes:E}=g,T=u.default.MEDIA_TYPES,_=[{thumbWidth:238,thumbHeight:58},{thumbWidth:110,thumbHeight:58},{thumbWidth:68,thumbHeight:50},{thumbWidth:88,thumbHeight:59}];return r.default({displayName:"backgroundPresetSection",propTypes:{title:s.default.string,infoTooltip:s.default.string,onSelectPreset:s.default.func,columns:s.default.number,desktopPresets:s.default.array.isRequired,mobilePresets:s.default.array},mixins:[o.mixins.editorAPIMixin],getInitialState(){const e=this.props.columns-1||0;return{thumbWidth:_[e].thumbWidth,thumbHeight:_[e].thumbHeight}},componentWillReceiveProps(e){const t=e.columns-1||0;this.setState({thumbWidth:_[t].thumbWidth,thumbHeight:_[t].thumbHeight})},isMediaVideo(e){return this.getMediaType(e)===T.VIDEO},getMediaType:e=>y.getMediaType(e.ref),getPresetData(){return this.getEditorAPI().isMobileEditor()?this.props.mobilePresets||{}:this.props.desktopPresets},getMediaPreviewComp(e){return this.getMediaType(e)!==T.COLOR?a.default.createElement(c.default,{data:e.ref}):null},getThumbStyle(e){let t,i={},a=b.SCALE_TO_FILL,r=E.CENTER;const s=this.getMediaType(e);if(e.thumbnail&&e.thumbnail.uri&&e.thumbnail.width&&e.thumbnail.height)t=n.default.omit(e.thumbnail,"title");else if(s!==T.COLOR){if(t=e.ref.mediaRef.posterImageRef||e.ref.mediaRef,e.ref.fittingType===b.LEGACY_BG_FIT_AND_TILE||e.ref.fittingType===b.TILE){a=y.isSmallerFromContainer(t.width,t.height,this.state.thumbWidth,this.state.thumbHeight)?b.TILE:b.FIT_AND_TILE}else a=b.SCALE_TO_FILL;r=e.ref.alignType}if(t){const e=y.getImageDisplayData(a,r,t.uri,t.width,t.height,this.state.thumbWidth,this.state.thumbHeight,90);i=e.css.container,i.backgroundImage="url(".concat(h.joinURL(f.staticMediaUrl,e.uri),")")}const o=v(this.getEditorAPI(),e.ref.color||"#ffffff");return o&&(i.backgroundColor=new d.default(o).alpha(e.ref.colorOpacity||1).rgbaString()),i.width="".concat(this.state.thumbWidth,"px"),i.height="".concat(this.state.thumbHeight,"px"),i},getThumbBackdropStyle(e){let t={};const i=b.TILE,a=E.CENTER;if(e.thumbnailBackground&&e.thumbnailBackground.uri&&e.thumbnailBackground.width&&e.thumbnailBackground.height){const r=y.getImageDisplayData(i,a,e.thumbnailBackground.uri,e.thumbnailBackground.width,e.thumbnailBackground.height,this.state.thumbWidth,this.state.thumbHeight,90);t=r.css.container;const s=h.isExternalUrl(r.uri)?r.uri:h.joinURL(f.staticMediaUrl,r.uri);t.backgroundImage="url(".concat(s,")")}return t.width="".concat(this.state.thumbWidth,"px"),t.height="".concat(this.state.thumbHeight,"px"),t},getOverlayStyle(e){const t=e.ref,i={},a=v(this.getEditorAPI(),t.colorOverlay);return a&&(i.backgroundColor=new d.default(a).alpha(t.colorOverlayOpacity||0).rgbaString()),i},selectPreset(e,t,i){this.props.onSelectPreset(n.default.cloneDeep(e),t,i)},render(){return m.apply(this)}})}.apply(t,a))||(e.exports=r)},1032:function(e,t,i){var a,r;a=[i,t,i(0),i(18),i(5),i(1),i(2),i(6),i(11),i(3),i(2)],void 0===(r=function(e,t,i,a,r,s,n,o,l,d,u){"use strict";a=i.__importDefault(a),r=i.__importDefault(r),s=i.__importDefault(s),n=i.__importStar(n),o=i.__importDefault(o),l=i.__importStar(l),d=i.__importDefault(d);const c=o.default.MEDIA_TYPES,{imageTransform:p,url:m,serviceTopology:h,backgroundUtils:f}=n,{getColorValue:g,getOverlayStyle:y}=f;return r.default({displayName:"mediaPreview",mixins:[l.mixins.editorAPIMixin],getInitialState:()=>({isPreviewReady:!1}),componentDidMount(){this.getMediaType()===c.VIDEO&&this.getInstance().addEventListener("timeupdate",this.onPlaying)},componentWillUnmount(){this.getMediaType()===c.VIDEO&&(this.getInstance().removeEventListener("timeupdate",this.onPlaying),this.removeVideoSecurely())},onPlaying(){this.state.isPreviewReady||this.setState({isPreviewReady:!0})},getInstance(){return a.default.findDOMNode(this.refs.videoInstance)},removeVideoSecurely(){const e=this.getInstance();e.pause(),s.default.forEach(e.children,(function(e){"source"===e.nodeName.toLowerCase()&&e.setAttribute("src","")})),e.load()},getMediaType(){return f.getMediaType(this.props.data)},isMediaVideo(){return this.getMediaType()===c.VIDEO},isMediaImage(){return this.getMediaType()===c.IMAGE},getOverlayStyle(){return y(this.props.data,this.getEditorAPI())},getBackgroundColor(){return{backgroundColor:g(this.getEditorAPI(),this.props.data.color)}},getBackgroundStyle(e){const t=this.props.data,i=e===c.VIDEO?t.mediaRef.posterImageRef:t.mediaRef;let a;if(t.fittingType===p.fittingTypes.LEGACY_BG_FIT_AND_TILE||t.fittingType===p.fittingTypes.TILE){a=f.isSmallerFromContainer(i.width,i.height,270,152)?p.fittingTypes.TILE:p.fittingTypes.FIT_AND_TILE}else a=p.fittingTypes.SCALE_TO_FILL;const r=f.getImageDisplayData(a,t.alignType,i.uri,i.width,i.height,270,152,85),s=r.css.container;return s.backgroundImage="url(".concat(m.joinURL(h.staticMediaUrl,r.uri),")"),s.opacity=i.opacity,s},getVideoSource(e){const t=this.props.data.mediaRef,i=t.videoId,a=(r=t.qualities,s.default.find(r,{quality:"480p"})||t.qualities[0]);var r;return m.joinURL(h.staticVideoUrl,i,a.quality,e,"file.".concat(e))},getVideoStyle(){return{width:270,height:152,opacity:this.props.data.mediaRef.opacity}},getSecInMin(){const e=this.props.data.mediaRef.duration,t=e%60,i=parseInt(e/60,10);return"".concat(i,":").concat(t<10?"0".concat(t):t)},getMediaCaption(){return this.props.data.mediaRef.title||""},render(){var e,t,i;return d.default.createElement("div",{className:"media-preview-panel"},d.default.createElement("div",{className:u.cx({"media-preview-wrapper":!0,hide:this.isMediaVideo()&&!this.state.isPreviewReady,show:this.isMediaVideo()&&this.state.isPreviewReady})},d.default.createElement("div",Object.assign({},{style:this.getBackgroundColor()},{className:u.cx("media-preview-color",null===(e={style:this.getBackgroundColor()})||void 0===e?void 0:e.className)})),this.isMediaImage()?d.default.createElement("div",Object.assign({key:"media-preview-image"},{style:this.getBackgroundStyle(this.getMediaType())},{className:u.cx("media-preview-image",null===(t={style:this.getBackgroundStyle(this.getMediaType())})||void 0===t?void 0:t.className)})):null,this.isMediaVideo()?d.default.createElement("div",Object.assign({key:"media-preview-video-wrapper"},{style:this.getVideoStyle()},{className:u.cx("media-preview-video-wrapper",null===(i={style:this.getVideoStyle()})||void 0===i?void 0:i.className)}),d.default.createElement("video",{autoPlay:!0,loop:!0,muted:!0,preload:"none",ref:"videoInstance",className:"media-preview-video"},d.default.createElement("source",{src:this.getVideoSource("mp4"),type:"video/mp4"}),d.default.createElement("source",{src:this.getVideoSource("webm"),type:"video/webm"}))):null,d.default.createElement("div",{style:this.getOverlayStyle(),className:"media-preview-overlay"})),d.default.createElement("div",{className:"media-preview-caption"},d.default.createElement("span",{className:"media-title"},this.getMediaCaption()),this.isMediaVideo()?d.default.createElement("span",{key:"video-duration",className:"video-duration"},this.getSecInMin()):null))}})}.apply(t,a))||(e.exports=r)},11:function(e,t){e.exports=l},18:function(e,t){e.exports=d},2:function(e,t){e.exports=i},3:function(e,t){e.exports=a},4:function(e,t){e.exports=r},5:function(e,t){e.exports=s},6:function(e,t){e.exports=n},9:function(e,t){e.exports=o},97:function(e,t){e.exports=u}})}));
//# sourceMappingURL=backgroundPresets.min.js.map