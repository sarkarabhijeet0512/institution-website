define("databaseEditor",["tslib","lodash","util","react","prop-types","create-react-class","constants","stateManagement","wix-base-ui","baseUI","santa-editor-symbols","core","experiment","santa-core-utils","panels","textControls","uiAnimations","wixRichText","mediaServices"],(function(e,t,i,s,a,l,r,n,d,o,u,c,p,m,_,h,f,g,b){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1552)}({0:function(t,i){t.exports=e},1:function(e,i){e.exports=t},10:function(e,t){e.exports=u},11:function(e,t){e.exports=c},111:function(e,t,i){var s,a;s=[i,t,i(0),i(4)],void 0===(a=function(e,t,i,s){"use strict";return{contextTypes:{dbEditorApi:(s=i.__importDefault(s)).default.object.isRequired},getDbEditorApi(){return this.context.dbEditorApi}}}.apply(t,s))||(e.exports=a)},13:function(e,t){e.exports=p},133:function(e,t,i){var s,a;s=[i,t,i(0),i(1),i(4),i(111)],void 0===(a=function(e,t,i,s,a,l){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),{propTypes:{item:a.default.object.isRequired,fieldDef:a.default.object.isRequired},mixins:[l.default],getFieldDisplayName(){return this.props.fieldDef.displayName||this.props.fieldDef.name},getFieldValue(e,t){const i=t||this.props;let s=i.item[i.fieldDef.name];var a;return e&&(a=s,s=(e||[]).reduce((function(e,t){return e&&e[t]}),a)),s},updateFieldValue(e,t){const i=[this.props.fieldDef.name].concat(t||[]).concat(e),s=i.reduceRight((function(e,t){const i={};return i[t]=e,i}));this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,s)},linkedFieldValue(e){const t=this;return{value:this.getFieldValue(e),requestChange(i){t.updateFieldValue(i,e)}}},hasLink(){return this.props.item.links&&!!this.props.item.links[this.props.fieldDef.name]},getLinkToFieldProps(){return s.default.pick(this.props,["item","fieldDef","visibleSections"])}}}.apply(t,s))||(e.exports=a)},1552:function(e,t,i){var s,a;s=[i,t,i(0),i(1553),i(1569),i(1570),i(1574)],void 0===(a=function(e,t,i,s,a,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importDefault(r),t.dbEditor=s.default,t.DbEditorApi=a.default,t.panels=l.default,t.BIService=r.default}.apply(t,s))||(e.exports=a)},1553:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(1),i(36),i(3),i(1554),i(1561),i(36)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importDefault(d),o=i.__importDefault(o),u=i.__importStar(u),s.default({displayName:"dbEditor",mixins:[r.animationManager],propTypes:{dbEditorApi:a.default.object.isRequired,currentListId:a.default.string,items:a.default.array,hiddenItems:a.default.array,currentItemId:a.default.string,listName:a.default.string,itemSchema:a.default.object,saveState:a.default.string,visibleFields:a.default.arrayOf(a.default.string)},childContextTypes:{dbEditorApi:a.default.object.isRequired,mediaServices:a.default.object},getDefaultProps:()=>({items:[]}),componentDidMount(){this.props.dbEditorApi.bi.dbEditorOpenSuccess(this.props.currentListId)},componentWillUnmount(){this.props.dbEditorApi.updateList()},getChildContext(){return{dbEditorApi:this.props.dbEditorApi,mediaServices:this.props.dbEditorApi.mediaServices}},getItem(e){return l.default.find(this.props.items,{_iid:e})||l.default.find(this.props.hiddenItems,{_iid:e})},blockMiddleMouseClick(e){if(1===e.button)return!1},render(){return n.default.createElement("div",{onMouseDown:this.blockMiddleMouseClick,className:"db-editor-container"},n.default.createElement(d.default,{items:this.props.items,hiddenItems:this.props.hiddenItems,openedItemId:this.props.currentItemId,listName:this.props.listName,listId:this.props.currentListId,visibleFields:this.props.visibleFields}),n.default.createElement(u.dbEditItemSlide,{direction:"right"},this.props.currentItemId?n.default.createElement(o.default,{key:"item-edit",item:this.getItem(this.props.currentItemId),itemSchema:this.props.itemSchema,visibleFields:this.props.visibleFields,saveState:this.props.saveState}):null))}})}.apply(t,s))||(e.exports=a)},1554:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(1),i(2),i(111),i(3),i(9),i(8),i(36),i(1555),i(1558),i(1559),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c,p,m,_,h){"use strict";function f(e){const t=this.getSelectedIds();return l.default.filter(e,(function(e){return l.default.includes(t,e._iid)}))}return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importDefault(d),o=i.__importStar(o),u=i.__importDefault(u),c=i.__importStar(c),p=i.__importDefault(p),m=i.__importDefault(m),_=i.__importDefault(_),s.default({displayName:"itemsList",mixins:[n.default,r.selectionMixin,r.propTypesFilterMixin],propTypes:{items:a.default.array.isRequired,hiddenItems:a.default.array.isRequired,openedItemId:a.default.string,listName:a.default.string.isRequired,listId:a.default.string.isRequired,visibleFields:a.default.arrayOf(a.default.string)},getDefaultProps:()=>({openedItemId:void 0}),getInitialState:()=>({itemsFilter:"all"}),duplicateSelectedItems(){this.getDbEditorApi().duplicateItems(f.call(this,this.filteredItems()),"multiple_selection"),this.clearSelection()},deleteSelectedItems(){this.getDbEditorApi().deleteItems(f.call(this,this.filteredItems()),"multiple_selection",this.clearSelection)},showHideSelectedItems(){const e=f.call(this,this.props.items),t=f.call(this,this.props.hiddenItems),i=t.length>0?"showItems":"hideItems";this.getDbEditorApi()[i](e.concat(t),"multiple_selection")},addItem(){const e=this.props.openedItemId?"item_view":"list_view";this.getDbEditorApi().addItem(e,function(e){this.getDbEditorApi().setCurrentItem(e)}.bind(this)),this.clearSelection(),l.default.includes(["all","visible"],this.state.itemsFilter)||this.setState({itemsFilter:"all"})},setCurrentItem(e){const t=this.getDbEditorApi(),i=this.props.openedItemId?"item_view":"list_view";t.setCurrentItem(e,i)},toggleItem(e){const t=this.isSelected(e);this.toggle(e),this.getDbEditorApi().bi.itemSelectionToggle(this.props.listId,e,!t)},toggleAllItems(){const e=l.default.map(this.filteredItems(),"_iid"),t=!l.default.isEmpty(this.getSelectedIds());this.toggleAll(e),this.getDbEditorApi().bi.allItemsSelectionToggle(this.props.listId,!t)},getItemsSelectionLabel(e){switch(e){case 0:return r.translate("list_dbe_select_all_label");case 1:return r.translate("list_dbe_1_items_selected");default:return r.translate("list_dbe_x_items_selected").replace("<X>",e)}},allItems(){return this.props.items.concat(this.props.hiddenItems)},setItemsFilter(e){this.setState({itemsFilter:e}),this.clearSelection()},filteredItems(){switch(this.state.itemsFilter){case"all":return this.allItems();case"visible":return this.props.items;case"hidden":return this.props.hiddenItems;default:return this.props.items}},shouldShowVisibleItems(){return this.props.items.length&&l.default.includes(["all","visible"],this.state.itemsFilter)},shouldShowHiddenItems(){return this.props.hiddenItems.length&&l.default.includes(["all","hidden"],this.state.itemsFilter)},render(){var e;const t=o.sortByDragList,i=this.getSelectedIds().length;return d.default.createElement("div",Object.assign({},this.filteredProps(),{className:h.cx("items-list ".concat(this.props.openedItemId?"small":""),null===(e=this.filteredProps())||void 0===e?void 0:e.className)}),d.default.createElement("header",{className:"list-header"},d.default.createElement("span",{className:"list-header-left-pane"},d.default.createElement("span",{className:"list-title"},this.props.listName),this.props.openedItemId?null:d.default.createElement(_.default,{key:"itemListFilter",value:this.state.itemsFilter,onChange:this.setItemsFilter})),d.default.createElement(o.button,{label:"list_dbe_edit_item_add_item",onClick:this.addItem,className:"add-item-btn"})),d.default.createElement("div",{className:this.props.openedItemId?"add-item-container":"select-all-container"},d.default.createElement("span",{className:"select-all-checkbox"},d.default.createElement(u.default.Checkbox,{labelAfterSymbol:!0,value:i>0,indeterminate:i>0&&i<this.filteredItems().length,label:this.getItemsSelectionLabel(i),shouldTranslate:!1,onChange:()=>{this.toggleAllItems()}})),this.props.openedItemId?d.default.createElement(o.button,{key:"list-view-add-btn",label:"list_dbe_edit_item_add_item",onClick:this.addItem,className:"small-add-item"}):null,this.getSelectedIds().length>0?d.default.createElement("span",{key:"multi-select-actions",className:"multi-select-action-menu checked"},d.default.createElement(o.button,{label:"list_dbe_duplicate_Items",icon:"duplicate",onClick:this.duplicateSelectedItems,className:"multi-duplicate"}),d.default.createElement(o.button,{label:"list_dbe_delete_items",icon:"delete",onClick:this.deleteSelectedItems,className:"multi-delete"}),d.default.createElement(o.button,{label:"list_dbe_show_hide_multiple_items",icon:"quickActionsShow",onClick:this.showHideSelectedItems,className:"multi-show-hide"})):null),0!==this.allItems().length||this.props.loading?null:d.default.createElement(m.default,{key:"no-items"}),d.default.createElement(u.default.CustomScroll,{heightRelativeToParent:"calc(100% - 120px)"},d.default.createElement("div",{className:this.props.openedItemId?"items-container-edit":"items-container"},this.shouldShowVisibleItems()?d.default.createElement(t,{ref:"sortList",key:"da-list",onItemMoved:this.getDbEditorApi().moveItem,childrenTransition:c.contentAddRemove,className:h.cx({"sort-list":!this.props.openedItemId,"item-edit-sort-list":this.props.openedItemId,"visible-items-container":!0})},l.default.map(this.props.items,(e,t)=>d.default.createElement(p.default,{key:e._iid,item:e,isHidden:!1,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(e._iid),visibleFields:this.props.visibleFields,onSelect:()=>{this.toggleItem(e._iid)},onStartDrag:e=>{this.props.openedItemId||this.refs.sortList.startDrag(t,e)},className:h.cx({"hidden-item":!1,selected:this.isSelected(e._iid),"no-hover":i>0,"is-open":this.props.openedItemId===e._iid})}))):null,this.shouldShowHiddenItems()?d.default.createElement("span",{key:"hidden-items-container",className:"hidden-items-container"},l.default.map(this.props.hiddenItems,e=>d.default.createElement(p.default,{key:e._iid,item:e,isHidden:!0,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(e._iid),visibleFields:this.props.visibleFields,onSelect:()=>{this.toggleItem(e._iid)},className:h.cx({"hidden-item":!0,selected:this.isSelected(e._iid),"no-hover":i>0,"is-open":this.props.openedItemId===e._iid})}))):null)))}})}.apply(t,s))||(e.exports=a)},1555:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(2),i(3),i(9),i(8),i(1556),i(1557),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l),r=i.__importDefault(r),n=i.__importStar(n),d=i.__importDefault(d),o=i.__importDefault(o),u=i.__importDefault(u),s.default({displayName:"itemListRow",mixins:[l.propTypesFilterMixin],propTypes:{item:a.default.object.isRequired,isOpened:a.default.bool.isRequired,isSelected:a.default.bool.isRequired,visibleFields:a.default.arrayOf(a.default.string),onSelect:a.default.func.isRequired,onStartDrag:a.default.func},render(){var e;return r.default.createElement("div",Object.assign({},this.filteredProps(),{className:c.cx("item-list-row",null===(e=this.filteredProps())||void 0===e?void 0:e.className)}),this.props.isOpened?null:r.default.createElement("span",{key:"drag-handle",onMouseDown:this.props.onStartDrag,className:"drag-handle-container"},r.default.createElement(n.symbol,{name:"dragHandle",className:"symbol-dragHandle"})),this.props.isOpened?null:r.default.createElement(d.default.Checkbox,{key:"item-checkbox",labelAfterSymbol:!0,value:this.props.isSelected,onChange:this.props.onSelect}),r.default.createElement(o.default,{item:this.props.item,showImage:!this.props.isOpened,visibleFields:this.props.visibleFields,isHidden:this.props.isHidden,className:c.cx({draggable:!0})}),r.default.createElement(u.default,{item:this.props.item,isHidden:this.props.isHidden}))}})}.apply(t,s))||(e.exports=a)},1556:function(e,t,i){var s,a;s=[i,t,i(0),i(1),i(5),i(4),i(2),i(111),i(3),i(9),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importDefault(d),o=i.__importStar(o),a.default({displayName:"itemDetails",mixins:[r.translationMixin,n.default],propTypes:{item:l.default.object.isRequired,showImage:l.default.bool,visibleFields:l.default.arrayOf(l.default.string)},getDefaultProps:()=>({showImage:!0}),getImageDef(){const e=(t=this.props.item,i=this.props.visibleFields,s.default.find(t,(function(e,t){return"wix:Image"===e._type&&s.default.includes(i,t)})));var t,i;const a=!!e,l=a&&!s.default.isEmpty(e.src);return{imageVisible:a,imageValid:l,props:l?function(e,t){const i={uri:e.src,width:e.width,height:e.height},s=r.imageTransform.getData(r.imageTransform.fittingTypes.SCALE_TO_FILL,{width:i.width,height:i.height,id:i.uri},{width:43,height:43,alignment:r.imageTransform.alignTypes.CENTER,htmlTag:"img"});return{src:"".concat(t.getServiceTopology().staticMediaUrl,"/").concat(s.uri),style:s.css.img}}(e,this.getDbEditorApi()):null}},editItem(){this.getDbEditorApi().setCurrentItem(this.props.item._iid,"hover_item")},render(){return d.default.createElement("div",{onClick:this.editItem,className:"item-details"},this.props.showImage&&this.getImageDef().imageVisible?(()=>{const e=this.getImageDef();return d.default.createElement("span",{key:"item-img-container",className:u.cx({"item-thumb-img":!0,noImage:!e.imageValid})},e.imageValid?d.default.createElement("img",Object.assign({key:"item-img-thumb"},e.props)):null,e.imageValid?null:d.default.createElement(o.symbol,{name:"camera",key:"item-img-symbol"}))})():null,d.default.createElement("span",{className:"item-title"},s.default.unescape(this.props.item.title)||"(Untitled Item)"))}})}.apply(t,s))||(e.exports=a)},1557:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(2),i(111),i(3),i(9)],void 0===(a=function(e,t,i,s,a,l,r,n,d){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l),r=i.__importDefault(r),n=i.__importDefault(n),d=i.__importStar(d),s.default({displayName:"itemActionMenu",mixins:[l.translationMixin,r.default],propTypes:{item:a.default.object.isRequired,isHidden:a.default.bool.isRequired},editItem(){const e=this.props.item._iid;this.getDbEditorApi().setCurrentItem(e,"hover_item")},duplicateItem(){this.getDbEditorApi().duplicateItems([this.props.item],"hover_item")},deleteItem(){this.getDbEditorApi().deleteItems([this.props.item],"hover_item")},showItem(){this.getDbEditorApi().showItems([this.props.item],"hover_item")},hideItem(){this.getDbEditorApi().hideItems([this.props.item],"hover_item")},render(){return n.default.createElement("div",{onClick:e=>{e.stopPropagation()},className:"item-action-menu"},n.default.createElement("div",{className:"action-buttons-container"},n.default.createElement(d.button,{label:"list_dbe_hover_item_duplicate_tooltip",icon:"duplicate",onClick:this.duplicateItem,className:"duplicate-item-button"}),n.default.createElement(d.button,{label:"list_dbe_hover_item_delete_tooltip",icon:"delete",onClick:this.deleteItem,className:"delete-item-button"}),this.props.isHidden?n.default.createElement(d.button,{key:"hoverItemShowBtn",label:"list_dbe_hover_item_show",icon:"quickActionsShow",onClick:this.showItem,className:"show-item-button"}):null,this.props.isHidden?null:n.default.createElement(d.button,{key:"hoverItemHideBtn",label:"list_dbe_hover_item_hide",icon:"quickActionsHide",onClick:this.hideItem,className:"hide-item-button"}),n.default.createElement(d.button,{label:"list_dbe_hover_item_edit",icon:"pencil",onClick:this.editItem,className:"edit-item-button"})))}})}.apply(t,s))||(e.exports=a)},1558:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(111),i(2),i(3),i(9)],void 0===(a=function(e,t,i,s,a,l,r,n){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l),r=i.__importDefault(r),n=i.__importStar(n),s.default({displayName:"noItems",mixins:[a.default,l.translationMixin],render(){return r.default.createElement("div",{className:"no-items"},r.default.createElement(n.symbol,{name:"createYourFirstItem",className:"no-items-image"}),r.default.createElement("span",{className:"no-items-title"},this.translateIfNeeded("list_dbe_this_list_is_empty")),r.default.createElement("div",{className:"no-items-click-container"},r.default.createElement("span",null,this.translateIfNeeded("list_dbe_empty_sate_line2"))))}})}.apply(t,s))||(e.exports=a)},1559:function(e,t,i){var s,a;s=[i,t,i(0),i(3),i(5),i(4),i(1),i(2),i(1560),i(9),i(10),i(6),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c,p){"use strict";s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importDefault(r),n=i.__importStar(n),d=i.__importDefault(d),o=i.__importStar(o),u=i.__importStar(u),c=i.__importDefault(c);const m={all:"list_dbe_items_filter_all",visible:"list_dbe_items_filter_visible",hidden:"list_dbe_items_filter_hidden"};function _(e){this.props.onChange(e),this.closeBubble()}return a.default({displayName:"itemListFilter",mixins:[n.translationMixin],propTypes:{value:l.default.oneOf(["all","visible","hidden"]).isRequired,onChange:l.default.func.isRequired},getInitialState:()=>({isBubbleOpen:!1}),getValueLabel(){return this.translateIfNeeded(m[this.props.value])},toggleBubble(){this.setState({isBubbleOpen:!this.state.isBubbleOpen})},closeBubble(){this.setState({isBubbleOpen:!1})},getBubbleContent(){return s.default.createElement(d.default,{value:this.props.value,onChange:_.bind(this),options:r.default.map(m,(function(e,t){return{label:e,value:t}}))})},render(){return s.default.createElement("span",{className:p.cx({"item-list-filter":!0,"is-open":this.state.isBubbleOpen})},s.default.createElement("span",null,this.translateIfNeeded("list_dbe_items_filter_label")," "),s.default.createElement("span",{ref:"handler",onClick:this.toggleBubble,className:"item-list-filter-value-label"},this.getValueLabel(),s.default.createElement(u.symbol,{name:"arrowDown"})),this.state.isBubbleOpen?s.default.createElement(o.bubble,{key:"itemFilterBubble",value:this.getBubbleContent(),closeTriggers:[c.default.UI.TOOLTIP.TRIGGERS.CLICK,c.default.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:c.default.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:c.default.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.closeBubble,targetNode:this.refs.handler}):null)}})}.apply(t,s))||(e.exports=a)},1560:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(1),i(2),i(3),i(10),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importStar(d),s.default({displayName:"itemListFilterBubble",mixins:[r.translationMixin],propTypes:{value:a.default.any.isRequired,onChange:a.default.func.isRequired,options:a.default.arrayOf(a.default.shape({label:a.default.string.isRequired,value:a.default.any.isRequired})).isRequired},render(){return n.default.createElement("div",{className:"item-list-filter-bubble"},l.default.map(this.props.options,e=>n.default.createElement("div",{key:e.value,onClick:()=>{this.props.onChange(e.value)},className:o.cx({"item-list-filter-bubble-option":!0,selected:this.props.value===e.value})},n.default.createElement(d.symbol,{name:"check"}),n.default.createElement("span",null,this.translateIfNeeded(e.label)))))}})}.apply(t,s))||(e.exports=a)},1561:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(1),i(2),i(111),i(1562),i(1563),i(1564),i(1565),i(1566),i(1568),i(3),i(9),i(8),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c,p,m,_,h,f,g){"use strict";s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importDefault(d),o=i.__importDefault(o),u=i.__importDefault(u),c=i.__importDefault(c),p=i.__importDefault(p),m=i.__importDefault(m),_=i.__importDefault(_),h=i.__importStar(h),f=i.__importDefault(f);const b={string:d.default,"string|asprice":d.default,"string|asbutton":o.default,"wix:image":c.default,"wix:richtext":p.default,"wix:video":m.default,"wix:date":u.default},v={Error:"list_dbe_edit_item_status_error",Saving:"list_dbe_edit_item_status_saving",Saved:"list_dbe_edit_item_status_saved",Idle:"list_dbe_edit_item_status_idle",Failed:"list_dbe_edit_item_status_error"},I={Title:"list_dbe_title_placeholder",Subtitle:"list_dbe_subtitle_placeholder",Description:"list_dbe_description_placeholder",Price:"list_dbe_price_placeholder",Video:"list_dbe_edit_item_video_link_placeholder"};function E(e){const t=e.metadata&&e.metadata.showAsHint,i=l.default.compact([e.type,t]).join("|");return b[i.toLowerCase()]}function D(e){if(e.item._iid!==this.props.item._iid)this.setState({saveLabel:null});else{let i=e.saveState!==this.props.saveState;i=i&&!("Idle"===e.saveState&&l.default.includes(["Saved","Failed","Error"],this.props.saveState)),i&&this.setState({saveLabel:(t=e.saveState,v[t])})}var t}return s.default({displayName:"itemEdit",mixins:[n.default,r.propTypesFilterMixin,r.blockOuterScrollMixin,r.translationMixin],propTypes:{item:a.default.object.isRequired,itemSchema:a.default.object.isRequired,saveState:a.default.string.isRequired,visibleFields:a.default.arrayOf(a.default.string)},getInitialState:()=>({saveLabel:null}),componentWillReceiveProps(e){D.call(this,e)},getFields(){const e=this;return l.default(e.props.itemSchema.fields).filter((function(t){return l.default.includes(e.props.visibleFields,t.name)||"title"===t.name})).map((function(e){return{component:E(e),definition:e,placeholder:I[e.displayName]||""}})).filter("component").value()},render(){var e;const t=this.props.item;return _.default.createElement("div",Object.assign({key:this.props.item._iid},this.filteredProps(),{className:g.cx("item-edit",null===(e=this.filteredProps())||void 0===e?void 0:e.className)}),_.default.createElement("div",{className:"no-scroll-container"},_.default.createElement("header",{className:"item-header"},_.default.createElement("div",{className:"button-container"},_.default.createElement(h.button,{icon:"arrowRight",label:"list_dbe_edit_item_close_item",onClick:()=>{this.getDbEditorApi().setCurrentItem(null)},className:"close-item-btn"})),_.default.createElement("span",{className:"action-container"},this.state.saveLabel?_.default.createElement("div",{key:"save-item-label",className:"save-item-label"},this.translateIfNeeded(this.state.saveLabel)):null,_.default.createElement(h.tooltip,{value:"list_dbe_hover_item_delete_tooltip"},_.default.createElement(h.button,{icon:"delete",onClick:()=>{this.getDbEditorApi().deleteItems([t],"edit_item")},className:"delete-item-btn"})),_.default.createElement(h.tooltip,{value:"list_dbe_hover_item_duplicate_tooltip"},_.default.createElement(h.button,{icon:"duplicate",onClick:()=>{this.getDbEditorApi().duplicateItems([t],"edit_item")},className:"duplicate-item-btn"}))))),_.default.createElement(f.default.CustomScroll,{heightRelativeToParent:"calc(100% - 67px)"},_.default.createElement("div",{className:"item-fields-container"},l.default.map(this.getFields(),(e,i)=>_.default.createElement("div",{key:e.definition.name,className:"item-field"},_.default.createElement(e.component,{ref:i,item:t,fieldDef:e.definition,placeholder:e.placeholder,visibleSections:{PhoneLink:!1}}))),_.default.createElement("div",{className:"unused-fields-text"},this.translateIfNeeded("list_dbe_edit_hiding_unused_fields")))))}})}.apply(t,s))||(e.exports=a)},1562:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(1),i(133),i(3),i(9),i(186),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importDefault(r),n=i.__importStar(n),d=i.__importDefault(d),s.default({displayName:"textItemField",mixins:[l.default],render(){var e;return r.default.createElement("div",{className:"text-item-field"},r.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),r.default.createElement("div",{className:"text-input"},r.default.createElement(n.textInput,{value:a.default.unescape(this.getFieldValue()),onChange:e=>{this.updateFieldValue(a.default.escape(e))},maxLength:500,placeholder:this.props.placeholder}),this.hasLink()?null:r.default.createElement(d.default,Object.assign({key:"noLink",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?r.default.createElement(d.default,Object.assign({key:"hasLink",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps(),{className:o.cx("input-link-to",null===(e=this.getLinkToFieldProps())||void 0===e?void 0:e.className)})):null)}})}.apply(t,s))||(e.exports=a)},1563:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(133),i(3),i(9),i(186)],void 0===(a=function(e,t,i,s,a,l,r,n){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),s.default({displayName:"buttonItemField",mixins:[a.default],render(){return l.default.createElement("div",{className:"text-item-field"},l.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),l.default.createElement("div",{className:"text-input"},l.default.createElement(r.textInput,{valueLink:this.linkedFieldValue(),placeholder:"list_dbe_button_placeholder",maxLength:100})),l.default.createElement(n.default,Object.assign({label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps()),'showIcon="',!0,'"'))}})}.apply(t,s))||(e.exports=a)},1564:function(e,t,i){var s,a;s=[i,t,i(0),i(3),i(5),i(1),i(9),i(133),i(9),i(6),i(10),i(2),i(36),i(186),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c,p,m,_){"use strict";s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importStar(d),o=i.__importDefault(o),u=i.__importStar(u),c=i.__importStar(c),p=i.__importStar(p),m=i.__importDefault(m);const h=["January","February","March","April","May","June","July","August","September","October","November","December"],f=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return a.default({displayName:"dateItemField",mixins:[n.default],getInitialState:()=>({dateBubbleOpen:!1}),getDatePicker(e){const t={value:e,onChange:this.updateDate,todayLabel:"list_DatePicker_TodayButton_Label",goToSelectedLabel:"list_DatePicker_GoToSelectedButton_Label",monthNames:l.default.map(h,(function(e){return"list_DatePicker_MonthsConstLong_".concat(e)})),days:l.default.map(f,(function(e){return"list_DatePicker_DayConstShort_".concat(e)})),startDay:"list_DatePicker_DayConstShort_Sunday",popOnlyValue:!0,showDelete:!0};return s.default.createElement(r.datePicker,t)},getValueAsDate(){const e=this.getFieldValue();return e&&e.iso?new Date(e.iso):null},updateDate(e){this.updateFieldValue(e?e.toISOString():"","iso"),this.toggleDateBubble()},toggleDateBubble(){this.setState({dateBubbleOpen:!this.state.dateBubbleOpen})},hideDateBubble(){this.setState({dateBubbleOpen:!1})},render(){var e;const t=this.getValueAsDate();return s.default.createElement("div",{className:"date-item-field"},s.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),s.default.createElement("div",{className:"text-input"},s.default.createElement("div",{onClick:this.toggleDateBubble,className:_.cx({"control-text-input":!0,"date-picker-open":this.state.dateBubbleOpen})},s.default.createElement(u.symbol,{name:"calendar"}),s.default.createElement("span",{ref:"dateSpan",className:_.cx({disabled:l.default.isEmpty(this.getFieldValue().iso)})},t?t.toLocaleDateString():c.translate("list_dbe_date_empty"))),this.hasLink()?null:s.default.createElement(m.default,Object.assign({key:"add-link-button",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?s.default.createElement(m.default,Object.assign({key:"link-to-field",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps(),{className:_.cx("input-link-to",null===(e=this.getLinkToFieldProps())||void 0===e?void 0:e.className)})):null,s.default.createElement(p.tooltipAnimation,null,this.state.dateBubbleOpen?s.default.createElement(d.bubble,{key:"dateBubble",value:this.getDatePicker(t),width:"301px",closeTriggers:[o.default.UI.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:o.default.UI.TOOLTIP.ALIGNMENT.BOTTOM,styleType:o.default.UI.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.hideDateBubble,targetNode:this.refs.dateSpan,ref:"popup",style:{position:"absolute"}}):null))}})}.apply(t,s))||(e.exports=a)},1565:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(1),i(133),i(3),i(9),i(186),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importDefault(r),n=i.__importStar(n),d=i.__importDefault(d),s.default({displayName:"imageItemField",mixins:[l.default],updateTitle(e){this.updateFieldValue(e,["title"])},getWPhotoData:e=>a.default.assign({type:"Image",uri:e.src},a.default.pick(e,["title","width","height"])),onMediaRemoved(e){const t={src:"",title:"",height:0,width:0};e&&a.default.assign(t,{src:e.uri,title:e.title,height:e.height,width:e.width}),this.updateFieldValue(t)},render(){var e;const t=this.getFieldValue();return r.default.createElement("div",null,r.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),r.default.createElement("div",{className:"image-item-field"},r.default.createElement(n.imageChangeRemove,{addButtonLabel:"list_dbe_edit_item_image_add_image",changeButtonLabel:"list_dbe_edit_item_change_image",removeButtonLabel:"list_dbe_edit_item_remove_image",onChange:this.onMediaRemoved,mediaManager:this.getDbEditorApi().mediaServices.mediaManager,focusEditorFunc:this.getDbEditorApi().mediaServices.setFocusToEditor,value:this.getWPhotoData(t),className:"image-panel"}),r.default.createElement("div",{className:"text-panel"},r.default.createElement(n.textInput,{label:"list_dbe_edit_item_alt",placeholder:"list_dbe_edit_item_alt_placeholder",value:t.title,onChange:this.updateTitle,maxLength:100,disabled:a.default.isEmpty(t.src)}),r.default.createElement(d.default,Object.assign({label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder",disabled:a.default.isEmpty(t.src),showIcon:!0},this.getLinkToFieldProps(),{className:o.cx("input-link-to",null===(e=this.getLinkToFieldProps())||void 0===e?void 0:e.className)})))))}})}.apply(t,s))||(e.exports=a)},1566:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(1),i(7),i(2),i(133),i(31),i(1567),i(3),i(187),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u,c,p){"use strict";s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importDefault(n),d=i.__importStar(d),o=i.__importDefault(o),u=i.__importDefault(u),c=i.__importDefault(c);const m=s.default({displayName:"richTextItemField",mixins:[n.default],getInitialState:()=>({editing:!1}),getToolbarProps(){const e=this.getDbEditorApi().getSiteInfo();return{themeColors:e.theme.colors.getAll(),themeFonts:e.theme.fonts.getAll(),fonts:d.fontUtils.getCurrentSelectableFontsWithParams(e),themeMap:e.theme.fonts.getMap(),isColorPickerClosed:this.isColorPickerClosed(),isLinkDialogClosed:this.isLinkDialogClosed(),isDeveloperMode:e.developerMode.isEnabled()}},isColorPickerClosed(){return this.props.isColorPickerClosed},isLinkDialogClosed(){return this.props.isLinkDialogClosed},getValue(){let e=this.getFieldValue();return"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(e=o.default.migrateToCurrentVersion(e)),{text:e.text,linkList:e.links}},getInitialValue(){return d.dataUtils.wrapOrphans(this.getValue().text)},handleDataChanged(e){this.updateValue({text:e,linkList:this.linksHelper.getAllLinks()})},updateValue(e){const t={text:e.text,links:e.linkList};"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(t.version=o.default.getCurrentVersion()),this.updateFieldValue(t)},getPanelManager(){return this.getDbEditorApi().panelManager},openLinkDialog(e,t){const i=this.getDbEditorApi(),s=r.link.getLinkPanelProps(i.documentServices,{link:e,callback:t,visibleSections:this.props.visibleSections});i.panelManager.openPanel("panels.toolPanels.linkPanel",s)},setReady(e){this.manager=e;const t=this;this.manager.onCmdStateChange((function(e){t.setState({cmdState:e})}));const i=this.getDbEditorApi().siteInfo.theme.fonts.getAll(),s=d.fontUtils.getUploadedUsedFonts(this.getValue().text,i);d.ckUtils.insertUploadedFontsToCk(s,this.manager),this.manager.onFocus((function(){t.onFocus()})),this.linksHelper.setCurrentLinks(this.getValue().linkList);const a=this.manager.getCommandsStates();this.setState({cmdState:a})},openColorPicker(e,t,i,s,a){this.getDbEditorApi().panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",{value:t,onChange:e,isBlockingLayerFullScreen:!0,shouldBlockOuterScroll:!0,top:s.top,left:s.left,previewOnHover:a},!0)},onFocus(){d.ckUtils.removeOverflowCss(this.manager),this.setState({editing:!0})},isFocusOnToolbar(){if(this.refs.toolbar)return!this.isColorPickerClosed()||!this.isLinkDialogClosed()||this.refs.toolbar.isAnyDropdownOpen()},onOuterClick(){this.isFocusOnToolbar()||(d.ckUtils.setOverflowCss(this.manager),this.setState({editing:!1}),this.clearUnusedLinks(),this.manager.unRegisterListener(this.handleCommandState))},getNonPasteableLinkTypes:()=>a.default.pick(r.link.LinkTypes,["PHONE_LINK"]),componentWillMount(){this.linksHelper=new d.LinksHelper([],this.getNonPasteableLinkTypes()),this.linksManager=new d.TextLinksManager(this.linksHelper),this.stylesManager={getFonts:a.default.partial(d.fontUtils.getCurrentSelectableFontsWithParams,this.getDbEditorApi().siteInfo,!1,!0)}},getStyleManager(){return this.stylesManager},getLinksManager(){return this.linksManager},onCutOrCopy(){this.linksHelper.cacheCopiedLinks()},clearUnusedLinks(){const e=this.linksHelper.getAllLinks(),t=this.manager.getLinkRefsList(),i=a.default.filter(e,(function(e){return a.default.includes(t,e.id)}));if(!a.default.isEqual(i,this.getValue().linkList)){const e=this;this.updateValue({text:e.getValue().text,linkList:i})}},render(){return u.default.createElement("div",{className:p.cx({"rich-text-item-field":!0,editing:this.state.editing})},u.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),u.default.createElement("div",{className:p.cx({"rich-text-input-control":!0,"rich-text-input":!0,"with-toolbar":this.state.editing})},u.default.createElement(d.richTextFrame,{onOuterClick:this.onOuterClick},this.state.editing?u.default.createElement(d.textToolBar,Object.assign({key:"textToolbar",ref:"toolbar",textManager:this.manager,linksHelper:this.linksHelper,cmdState:this.state.cmdState,openLinkPanel:this.openLinkDialog,openColorPicker:this.openColorPicker},this.getToolbarProps())):null,u.default.createElement(c.default.TextEditor,{initialData:this.getInitialValue(),onReady:this.setReady,showToolbar:!1,validateHtml:!1,documentServicesApi:this.getDbEditorApi().siteInfo,stylesManager:this.getStyleManager(),linksManager:this.getLinksManager(),onDataChange:this.handleDataChanged,autoGrow:!1,onCut:this.onCutOrCopy,onCopy:this.onCutOrCopy}))))}});return r.hoc.connect(e=>({isColorPickerClosed:l.default.editorPlugins.panels.selectors.isColorPickerClosed(e),isLinkDialogClosed:l.default.editorPlugins.panels.selectors.isLinkDialogClosed(e)}))(m)}.apply(t,s))||(e.exports=a)},1567:function(e,t,i){var s,a;s=[i,t,i(0),i(1)],void 0===(a=function(e,t,i,s){"use strict";s=i.__importDefault(s);const a=/<hatul[^>]*>/gi,l=/<\/hatul>/gi;return{migrateToCurrentVersion:function(e){return s.default.get(e,"version",0)>=3||(e.text=e.text.replace(a,"").replace(l,""),e.version=3),e},getCurrentVersion:function(){return 3}}}.apply(t,s))||(e.exports=a)},1568:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(1),i(2),i(133),i(3),i(9)],void 0===(a=function(e,t,i,s,a,l,r,n,d){"use strict";function o(){this.success=!0;if(this.setState({status:"valid"}),a.default.isEmpty(this.state.videoUrl))this.updateFieldValue({videoId:""});else{const e=l.videoUtils.getVideoDataFromUrl(this.state.videoUrl);this.updateFieldValue({videoType:e.videoType,videoId:e.videoId})}a.default.delay(function(){this.success=!1,this.setState({status:"idle"})}.bind(this),2e3)}function u(){this.setState({status:"invalid"}),this.refs.textInput.focus()}return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importStar(l),r=i.__importDefault(r),n=i.__importDefault(n),d=i.__importStar(d),s.default({displayName:"videoItemField",mixins:[r.default],getInitialState(){return{status:"idle",videoUrl:this.getVideoUrl()}},componentWillReceiveProps(e){const t=this.getVideoUrl(e);a.default.isEqual(this.getVideoUrl(),t)||this.updateVideoUrl(t)},getVideoUrl(e){return l.videoUtils.getVideoUrl(this.getFieldValue(null,e))},updateVideoUrl(e){this.setState({status:this.success?this.state.status:"idle",videoUrl:e})},handleClick(){a.default.isEmpty(this.state.videoUrl)?a.default.defer(o.bind(this)):l.videoUtils.verifyVideoUrl(this.state.videoUrl,o.bind(this),u.bind(this))},render(){const e=this.state.status;return n.default.createElement("div",{className:"video-item-field"},n.default.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),n.default.createElement("div",{className:"inputs-container ".concat(e)},n.default.createElement(d.videoInput,{valueLink:this.linkedFieldValue(),nonEmptyButtonLabel:"list_dbe_edit_item_search_video",emptyButtonLabel:"list_dbe_edit_item_search_video",panelManager:this.getDbEditorApi().panelManager}),n.default.createElement("div",null,n.default.createElement(d.textInput,{ref:"textInput",label:"list_dbe_edit_item_video_url",value:this.state.videoUrl,onChange:this.updateVideoUrl,placeholder:this.props.placeholder,className:"video-url-input"}),n.default.createElement("div",{className:"error-msg-and-button"},n.default.createElement("span",null,"invalid"===e?l.translate("list_dbe_edit_item_bad_video_url"):""),this.state.videoUrl!==this.getVideoUrl()&&"idle"===e?n.default.createElement(d.button,{key:"update-button",label:"list_dbe_edit_item_update_video_url",onClick:this.handleClick,className:"update-button"}):null,"idle"!==e?n.default.createElement(d.symbol,{key:"validation-status",name:"valid"===e?"inputValidationSuccess":"inputValidationError"}):null))))}})}.apply(t,s))||(e.exports=a)},1569:function(e,t,i){var s,a;s=[i,t,i(0),i(1),i(249),i(2),i(13)],void 0===(a=function(e,t,i,s,a,l,r){"use strict";s=i.__importDefault(s),a=i.__importStar(a),l=i.__importStar(l),r=i.__importDefault(r);const n="Idle",d="Saved",o="Failed",u="Saving";function c(e){return"databaseEditor.panels.".concat(e)}function p(e){const t=this.dataService.wasRepoLoadErroneous(),i=this.dataService.wasListLoadErroneous(e);t||i?(this.bi.listLoadFailed(e,!t,!i),this.panelManager.openPanel(c("loadFailedMessagePanel"),{onConfirm(){window.location.reload()}})):m.call(this)}function m(){const e=v.call(this);s.default.forEach(this.stateChangedCallbacks,(function(t){t(e)}))}function _(){return this.appbuilderServices.data.lists.getItems(this.currentListId)}function h(){return this.appbuilderServices.data.lists.getHiddenItems(this.currentListId)}function f(){return this.appbuilderServices.data.lists.getListName(this.currentListId)}function g(){const e=this.appbuilderServices.layout.getAllFields,t=s.default(this.currentListId).thru(e).reject("hidden").map("name").value(),i=s.default(e(this.currentListId,"Mobile")).reject("hidden").map("name").value();return s.default.uniq(t.concat(i))}function b(e,t){t?window.setTimeout(b.bind(this,e),t):(this.saveState=e,m.call(this))}function v(){const e=this.dataService.wasRepoLoaded(),t=e&&this.dataService.wasListLoaded(this.currentListId);return{currentListId:this.currentListId,items:t?_.call(this):[],hiddenItems:t?h.call(this):[],currentItemId:this.currentItemId,listName:e?f.call(this):null,itemSchema:e?this.appbuilderServices.data.lists.getItemSchema(this.currentListId):null,visibleFields:this.visibleFields,dbEditorApi:this,openPanels:this.panelManager.getOpenPanels(),saveState:this.saveState,loading:!t}}function I(){this.sohuldRender=!0,!0!==this.disableAutoSave?this.saveState!==u?(b.call(this,u),this.appbuilderServices.save(function(){if(b.call(this,d),this.savePending)return this.savePending=!1,void I.call(this);window.setTimeout(function(){this.saveState!==u&&b.call(this,n)}.bind(this),this.idleTimeout)}.bind(this),function(){this.savePending=!1,b.call(this,o),b.call(this,n,this.idleTimeout),this.panelManager.openPanel(c("saveFailedMessagePanel"))}.bind(this))):this.savePending=!0:m.call(this)}function E(e,t){return s.default.filter(e,(function(e){return s.default.find(t,{_iid:e._iid})}))}function D(e,t){const i=s.default.assign({},t,{title:l.translate("list_dbe_prefix_for_duplicated_item")+t.title});return this.appbuilderServices.data.items.create(e,i)}function S(e,t,i,l,d,o,u,c,m,_,h){s.default.bindAll(this,["getServiceTopology","setCurrentList","getPagesData","getSiteMenuItems","createDefaultDataItem","setCurrentItem","debouncedSave","broadcastStateChanged","moveItem","addItem","updateItem","duplicateItems","deleteItems","showItems","hideItems","getCurrentListVersion","registerForStateChanged","getSiteInfo"]),this.disableAutoSave=_,this.idleTimeout=c,this.dataService=e,this.appbuilderServices=i.wixapps.appbuilder,this.documentServices=i,this.siteInfo=l,this.serviceTopology=d,this.stateChangedCallbacks=[],this.currentListId=u,this.currentItemId=null,this.saveState=n,this.savePending=!1,this.sohuldRender=!1,this.panelManager=function(e){const t=Object.create(e);return t.openPanel=function(t,i){e.openPanel(t,i,!0)},t}(o),this.mediaServices=h||a.create(this),this.bi=t,r.default.isOpen("appBuilderDataMigration")&&this.appbuilderServices.migration.migrateList(u),e.registerForUpdates(p.bind(this)),m&&(this.visibleFields=g.call(this),m(v.call(this)))}return S.prototype={updateList(){this.sohuldRender&&s.default.has(this.appbuilderServices.data,"markDataAsUpdated")&&(this.appbuilderServices.data.markDataAsUpdated(this.currentListId),this.sohuldRender=!1)},getServiceTopology(){return this.serviceTopology},setCurrentList(e){this.currentListId=e,this.currentItemId=null,this.dataService.loadListData(e),this.visibleFields=g.call(this),m.call(this)},getPagesData(){return this.dsRead.pages.getPagesData()},getSiteMenuItems(){return this.dsRead.mainMenu.getMenu()},createDefaultDataItem(e){return this.dsRead.data.createItem(e)},setCurrentItem(e,t){this.currentItemId=e,m.call(this),e&&t&&this.bi.itemEdit(t,this.currentListId,e)},debouncedSave:s.default.debounce(I,500),broadcastStateChanged:m,moveItem(e,t){const i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=i.itemIds,a=s[e];s.splice(t,0,s.splice(e,1)[0]),this.bi.itemMove(this.currentListId,i.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),I.call(this)},addItem(e,t){t=t||s.default.noop;const i=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),a=this.appbuilderServices.data.items.create(i),l=this.appbuilderServices.data.lists.selection.get(this.currentListId),r=l.itemIds;return r.unshift(a),this.bi.itemAdd(e,this.currentListId,l.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,r),t(a),I.call(this),a},updateItem(e,t,i){this.appbuilderServices.data.items.update(e,t,i),this.debouncedSave(),m.call(this)},duplicateItems(e,t){const i=s.default.map(e,"_iid"),a=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),l=this.appbuilderServices.data.lists.selection.get(this.currentListId);this.bi.itemsDuplicate(t,this.currentListId,l.id,i),s.default.forEach(E(e,h.call(this)),s.default.bind(D,this,a));const r=s.default.map(E(e,_.call(this)),s.default.bind(D,this,a)),n=l.itemIds,d=s.default.findLastIndex(n,(function(e){return s.default.includes(i,e)}));n.splice.apply(n,[d+1,0].concat(r)),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,n),this.currentItemId&&this.setCurrentItem(s.default.last(r)),I.call(this)},deleteItems(e,t,i){const a=this;i=i||s.default.noop,this.panelManager.openPanel(c("deleteItemsConfirmationPanel"),{onConfirm:function(){const l=a.appbuilderServices.data.lists.selection.get(a.currentListId);a.bi.itemsDelete(t,a.currentListId,l.id,s.default.map(e,"_iid")),s.default.forEach(e,(function(e){if(a.currentItemId===e._iid){const t=s.default.map(_.call(a),"_iid"),i=t.indexOf(e._iid),l=t[i+1]||t[i-1]||null;a.setCurrentItem(l)}a.appbuilderServices.data.items.delete(e._type,e._iid)})),i(),I.call(a)},onCancel:s.default.noop})},showItems(e){const t=this.appbuilderServices.data.lists.selection.get(this.currentListId),i=s.default.map(e,"_iid"),a=s.default.union(t.itemIds,i);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),I.call(this)},hideItems(e){const t=this.appbuilderServices.data.lists.selection.get(this.currentListId),i=s.default.map(e,"_iid"),a=s.default.difference(t.itemIds,i);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),I.call(this)},getCurrentListVersion(){return this.appbuilderServices.data.lists.getListVersion(this.currentListId)},registerForStateChanged(e){this.stateChangedCallbacks.push(e)},getSiteInfo(){return this.siteInfo}},S}.apply(t,s))||(e.exports=a)},1570:function(e,t,i){var s,a;s=[i,t,i(0),i(1571),i(1572),i(1573)],void 0===(a=function(e,t,i,s,a,l){"use strict";return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),{deleteItemsConfirmationPanel:s.default,saveFailedMessagePanel:a.default,loadFailedMessagePanel:l.default}}.apply(t,s))||(e.exports=a)},1571:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(2),i(3),i(19),i(9)],void 0===(a=function(e,t,i,s,a,l,r,n){"use strict";return s=i.__importDefault(s),a=i.__importStar(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importStar(n),s.default({displayName:"deleteItems",mixins:[a.translationMixin],render(){return l.default.createElement(r.frames.confirmationPanelFrame,{panelName:this.props.panelName,type:"important",panelTitle:this.translateIfNeeded("list_dbe_delete_are_you_sure_title"),onCancel:this.props.onCancel,onConfirm:this.props.onConfirm,confirmLabel:"list_dbe_delete_are_you_sure_confirm_button",cancelLabel:"list_dbe_delete_are_you_sure_cancel_button",className:"delete-list-items-confirmation"},l.default.createElement(n.symbol,{name:"garbage-truck-clipart",className:"image"}),l.default.createElement("div",{className:"text"},l.default.createElement("span",null,this.translateIfNeeded("list_dbe_delete_items_subtitle")),l.default.createElement("span",null,this.translateIfNeeded("list_dbe_delete_are_you_sure_text"))))}})}.apply(t,s))||(e.exports=a)},1572:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(2),i(11),i(3),i(19),i(9),i(8)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o){"use strict";return s=i.__importDefault(s),a=i.__importStar(a),l=i.__importStar(l),r=i.__importDefault(r),n=i.__importStar(n),d=i.__importStar(d),o=i.__importDefault(o),s.default({displayName:"saveFailedMessagePanel",mixins:[a.translationMixin,l.mixins.editorAPIMixin],render(){return r.default.createElement(n.frames.messagePanelFrame,{panelName:this.props.panelName,confirmLabel:"list_dbe_general_error_button",panelTitle:this.translateIfNeeded("list_dbe_general_error_dialog_title"),className:"list-save-failed-panel"},r.default.createElement(o.default.Composites.RichTextWithIllustration,null,r.default.createElement(o.default.Illustration,null,r.default.createElement(d.symbol,{name:"plaster",className:"error-img"})),r.default.createElement(o.default.Composites.RichText,null,r.default.createElement(o.default.RichText,{type:"T01"},r.default.createElement("div",null,this.translateIfNeeded("list_dbe_general_error_dialog_subtitle")),r.default.createElement("div",null,this.translateIfNeeded("list_dbe_general_error_dialog_text")),r.default.createElement("br",null),r.default.createElement("div",null,this.translateIfNeeded("list_dbe_general_error_dialog_text_2")),r.default.createElement("a",{href:"https://www.wix.com/support/html5/",className:"support-link"},"https://www.wix.com/support/")))))}})}.apply(t,s))||(e.exports=a)},1573:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(2),i(3),i(19),i(9)],void 0===(a=function(e,t,i,s,a,l,r,n){"use strict";return s=i.__importDefault(s),a=i.__importStar(a),l=i.__importDefault(l),r=i.__importStar(r),n=i.__importStar(n),s.default({displayName:"loadFailedMessagePanel",mixins:[a.translationMixin],render(){return l.default.createElement(r.frames.confirmationPanelFrame,{panelName:this.props.panelName,panelTitle:this.translateIfNeeded("list_dbe_loading_error_title"),onConfirm:this.props.onConfirm,onCancel:this.props.onCancel,confirmLabel:"list_dbe_loading_error_button",cancelLabel:"list_dbe_error_loading_close_manage_items",className:"list-load-failed-panel"},l.default.createElement(n.symbol,{name:"plaster",className:"error-img"}),l.default.createElement("div",{className:"msg-text"},l.default.createElement("span",null,this.translateIfNeeded("list_dbe_loading_error_subtitle")),l.default.createElement("span",null,this.translateIfNeeded("list_dbe_loading_error_text")),l.default.createElement("a",{href:"https://www.wix.com/support/html5/",className:"support-link"},"https://www.wix.com/support/")))}})}.apply(t,s))||(e.exports=a)},1574:function(e,t,i){var s,a;s=[i,t,i(0),i(1575),i(17)],void 0===(a=function(e,t,i,s,a){"use strict";function l(e){this._reportBI=e}return s=i.__importDefault(s),a=i.__importDefault(a),l.prototype={sendEvent(e,t){try{this._reportBI(e,t)}catch(e){a.default.log.info("Error sending BI event",e)}},dbEditorOpenSuccess(e){this.sendEvent(s.default.LIST_DB_MANAGER_OPENED,{list_part_id:e})},dbEditorOpenFailed(e,t){this.sendEvent(s.default.LIST_DB_MANAGER_ERROR_LOADING,{list_part_id:e,error_description:t.toString()})},listLoadFailed(e,t,i){this.sendEvent(s.default.LIST_DB_MANAGER_LIST_LOAD_FAIL,{list_part_id:e,repo_loaded:t?"true":"false",data_loaded:i?"true":"false"})},itemMove(e,t,i){this.sendEvent(s.default.LIST_DB_MANAGER_REORDER_ITEMS_DROP,{item_id:i,list_part_id:e,selector_id:t})},itemAdd(e,t,i,a){this.sendEvent(s.default.LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK,{origin:e,list_part_id:t,selector_id:i,item_id:a})},itemsDuplicate(e,t,i,a){this.sendEvent(s.default.LIST_DB_MANAGER_DUPLICATE_ITEM,{origin:e,list_part_id:t,selector_id:i,source_item_ids:a.join(",")})},itemsDelete(e,t,i,a){this.sendEvent(s.default.LIST_DB_MANAGER_DELETE_ITEMS_CLICK,{origin:e,list_part_id:t,selector_id:i,item_ids:a.join(",")})},itemEdit(e,t,i){this.sendEvent(s.default.LIST_DB_MANAGER_EDIT_ITEM_CLICK,{origin:e,list_part_id:t,item_id:i})},itemSelectionToggle(e,t,i){this.sendEvent(s.default.LIST_DB_MANAGER_SELECT_ITEM_CLICK,{list_part_id:e,item_id:t,state_after_click:!!i})},allItemsSelectionToggle(e,t){this.sendEvent(s.default.LIST_DB_MANAGER_SELECT_ALL_CLICK,{list_part_id:e,state_after_click:!!t})}},l}.apply(t,s))||(e.exports=a)},1575:function(e,t,i){var s;void 0===(s=function(e,t){"use strict";return{LIST_DB_MANAGER_OPENED:{src:59,endpoint:"listim2",evid:107,fields:{list_part_id:"string"}},LIST_DB_MANAGER_ERROR_LOADING:{src:59,endpoint:"listim2",evid:108,fields:{list_part_id:"string",error_description:"string"}},LIST_DB_MANAGER_REORDER_ITEMS_DROP:{src:59,endpoint:"listim2",evid:109,fields:{item_id:"string",list_part_id:"string",selector_id:"string"}},LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK:{src:59,endpoint:"listim2",evid:110,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_id:"string"}},LIST_DB_MANAGER_SELECT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:113,fields:{list_part_id:"string",item_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_SELECT_ALL_CLICK:{src:59,endpoint:"listim2",evid:114,fields:{list_part_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_DUPLICATE_ITEM:{src:59,endpoint:"listim2",evid:117,fields:{origin:"string",list_part_id:"string",selector_id:"string",source_item_ids:"string"}},LIST_DB_MANAGER_DELETE_ITEMS_CLICK:{src:59,endpoint:"listim2",evid:118,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_ids:"string"}},LIST_DB_MANAGER_EDIT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:119,fields:{origin:"string",list_part_id:"string",item_id:"string"}},LIST_DB_MANAGER_LIST_LOAD_FAIL:{src:59,endpoint:"listim2",evid:121,fields:{list_part_id:"string",repo_loaded:"bool",data_loaded:"bool"}}}}.apply(t,[i,t]))||(e.exports=s)},17:function(e,t){e.exports=m},186:function(e,t,i){var s,a;s=[i,t,i(0),i(5),i(4),i(1),i(111),i(3),i(19),i(2),i(2)],void 0===(a=function(e,t,i,s,a,l,r,n,d,o,u){"use strict";function c(){var e;return n.default.createElement(d.commonControls.linkTo,Object.assign({value:this.getLinkData(),onChange:this.setLinkData,showButton:!1,showIcon:!0},this.filterProps(),{className:u.cx(o.inheritClassName("input-link-to-field"),null===(e=this.filterProps())||void 0===e?void 0:e.className)}))}function p(){return n.default.createElement(d.commonControls.linkToButton,Object.assign({value:this.getLinkData(),onChange:this.setLinkData},this.filterProps()))}return s=i.__importDefault(s),a=i.__importDefault(a),l=i.__importDefault(l),r=i.__importDefault(r),n=i.__importDefault(n),d=i.__importStar(d),o=i.__importStar(o),s.default({displayName:"linkToField",propTypes:{item:a.default.object.isRequired,fieldDef:a.default.object.isRequired,useLinkButton:a.default.bool,label:a.default.string,placeholder:a.default.string,minCharsForTooltip:a.default.number,showButton:a.default.bool,buttonEditLabel:a.default.string,buttonAddLabel:a.default.string},mixins:[r.default],getDefaultProps:()=>({useLinkButton:!1}),getLinkData:function(){return this.props.item.links&&this.props.item.links[this.props.fieldDef.name]},setLinkData(e){const t={};t[this.props.fieldDef.name]=e,this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,{links:t})},filterProps(){return l.default.omit(this.props,["pages","anchors","value","onChange","valueLink"])},render(){return(this.props.useLinkButton?p:c).call(this)}})}.apply(t,s))||(e.exports=a)},187:function(e,t){e.exports=g},19:function(e,t){e.exports=_},2:function(e,t){e.exports=i},249:function(e,t){e.exports=b},3:function(e,t){e.exports=s},31:function(e,t){e.exports=h},36:function(e,t){e.exports=f},4:function(e,t){e.exports=a},5:function(e,t){e.exports=l},6:function(e,t){e.exports=r},7:function(e,t){e.exports=n},8:function(e,t){e.exports=d},9:function(e,t){e.exports=o}})}));
//# sourceMappingURL=databaseEditor.min.js.map