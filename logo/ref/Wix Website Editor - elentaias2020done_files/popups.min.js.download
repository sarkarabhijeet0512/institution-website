define("popups",["tslib","lodash","util","coreBi"],(function(e,t,o,n){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=2119)}({0:function(t,o){t.exports=e},1:function(e,o){e.exports=t},12:function(e,t){e.exports=n},155:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(513)],void 0===(a=function(e,t,o,n,a){"use strict";function u(e,t){return n.default.isEmpty(e)?t.behaviors.getDefinition(a.default.OPEN_POPUP_BEHAVIOR):e[0]}function p(e,t){const o=e.dsRead.siteSegments.getSiteStructureId();return n.default.find(t,{pageId:o})}function r(e,t,o){const a=p(e,t);return a?n.default.map(o,(function(e){return n.default.defaults({pageId:e},a)})):t}return n=o.__importDefault(n),a=o.__importDefault(a),{isOpenInMobile:function(e,t){return u(e,t).params[a.default.FLAG_MOBILE]},isMasterPageSelected:function(e,t){return!!p(e,t)},findMasterPageBehavior:p,getCurrentOpenBehaviors:function(e){const t=e.dsRead.pages.popupPages.getCurrentPopupId();return e.pages.popupPages.getOpenBehaviorsForPopupWithId(t)},getSomeBehavior:u,getDelay:function(e,t){return u(e,t).params.delay},getDenormalizedBehaviors:r,getDisabledPageIds:function(e,t,o){const a=o.dsRead.pages.getPageIdList(),u=r(o,e,a);return n.default(u).reject({popupId:t}).map("pageId").value()}}}.apply(t,n))||(e.exports=a)},2:function(e,t){e.exports=o},2119:function(e,t,o){var n,a;n=[o,t,o(0),o(2120),o(2122),o(2124),o(2126),o(2127)],void 0===(a=function(e,t,o,n,a,u,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=o.__importDefault(n),a=o.__importDefault(a),u=o.__importDefault(u),p=o.__importDefault(p);const s={closeButtons:n.default,openBehaviors:a.default};t.actions=s;const i={desktopPanel:u.default,mobilePanel:p.default,pagesSelectorPanel:r.getPageSelectorPanelProps};t.mappers=i}.apply(t,n))||(e.exports=a)},2120:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(2),o(278),o(2121)],void 0===(a=function(e,t,o,n,a,u,p){"use strict";function r(e,t,o){const u=e.pages.popupPages.getCurrentPopup(),r=e.pages.popupPages.getPopupContainer(),s=e.components.layout.get(r);s.width=Math.min(980,s.width);const i=function(e,t,o){return n.default.defaults({layout:a.layoutUtils.convertAnyPositionToLeftTopPosition(n.default.assign({},e.layout,o),t)},e)}(p.default[t](e),s,o);e.components.add(r,i),e.history.add("added close ".concat(t," button to popup ").concat(u.id))}function s(e,t){const o=e.pages.popupPages.getCurrentPopup(),a=e.components.get.byType(t,o);n.default.isEmpty(a)||e.components.remove(a).then(t=>{t&&e.history.add("removed close buttons from popup ".concat(o.id))})}return n=o.__importDefault(n),a=o.__importStar(a),u=o.__importDefault(u),p=o.__importDefault(p),{addIconButton:function(e){r(e,u.default.ICON_TYPE,{y:20,right:20})},addTextButton:function(e){r(e,u.default.TEXT_TYPE,{center:0,bottom:20})},removeIconButton:function(e){s(e,u.default.ICON_TYPE)},removeTextButton:function(e){s(e,u.default.TEXT_TYPE)}}}.apply(t,n))||(e.exports=a)},2121:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(278)],void 0===(a=function(e,t,o,n,a){"use strict";n=o.__importDefault(n);const u={};return u[(a=o.__importDefault(a)).default.ICON_TYPE]=function(e){const t=e.addPanel.getSectionsByComponentType(a.default.ICON_TYPE,null),o=n.default.get(t,"0.props.items.0.structure");return o.layout=n.default.omit(o.layout,["x","y"]),o},u[a.default.TEXT_TYPE]=function(e){const t=e.addPanelInfra.componentsDefaultData.getComponentDefault(a.default.TEXT_TYPE),o=n.default.head(function(e){return e.addPanelInfra.addPanelStyleManager.getComponentThemeStyles(a.default.TEXT_TYPE,e.theme,e.components)}(e));return t.layout=t.panelLayout,t.style=o,delete t.panelLayout,t},u}.apply(t,n))||(e.exports=a)},2122:function(e,t,o){var n,a;n=[o,t,o(0),o(12),o(1),o(2123),o(155),o(513)],void 0===(a=function(e,t,o,n,a,u,p,r){"use strict";function s(e){return a.default(e.enabledPageIds).union(e.selectedPageIds).size()}function i(e,t,o){const n=s(t);l(e,{all_pages_selected:o,num_selected_pages:o?n:0,num_unselected_pages:o?0:n})}function d(e,t,o,n){const u=s(t),p=o?a.default(t.selectedPageIds).push(n).size():a.default(t.selectedPageIds).pull(n).size();l(e,{all_pages_selected:u===p,num_selected_pages:p,num_unselected_pages:u-p})}function l(e,t){e.bi.event(n.events.popups.POP_UP_SETTINGS_PAGE_SELECTOR_OK,t)}function f(e,t,o,n){const a=e.components.get.byId(t),u=e.components.get.byId(o),p=e.actions.getDefinition(r.default.LOAD_ACTION),s=e.behaviors.getDefinition(r.default.OPEN_POPUP_BEHAVIOR);s.params=n,e.behaviors.update(a,p,u,s)}function c(e,t,o){const n=e.components.get.byId(t),a=e.components.get.byId(o),u=e.actions.getDefinition(r.default.LOAD_ACTION),p=e.behaviors.getDefinition(r.default.OPEN_POPUP_BEHAVIOR);e.behaviors.remove(n,u,a,p)}function g(e,t){a.default.forEach(t,(function(t){c(e,t.pageId,t.popupId)}))}return n=o.__importStar(n),a=o.__importDefault(a),u=o.__importDefault(u),p=o.__importDefault(p),r=o.__importDefault(r),{assignOpenBehaviorOnlyToCurrentPage:function(e){const t=u.default(e),o=e.dsRead.pages.getPrimaryPageId();d(e,t,!0,o),a.default.has(t.disabledPageIds,o)||(g(e,t.openBehaviors),f(e,o,t.popupPointer.id,t.behaviorDefaults),e.history.add("assign open behavior only to current page"))},removeOpenBehaviorFromAllPages:function(e){const t=u.default(e);g(e,t.openBehaviors),i(e,t,!1),e.history.add("remove open behavior from all pages")},assignOpenBehaviorToAllPages:function(e){const t=u.default(e),o=t.popupPointer.id,n=t.openBehaviors;p.default.isMasterPageSelected(e,n)||(a.default.isEmpty(t.disabledPageIds)?(g(e,n),f(e,e.dsRead.siteSegments.getSiteStructureId(),o,t.behaviorDefaults)):a.default(t.enabledPageIds).difference(t.selectedPageIds).forEach((function(n){f(e,n,o,t.behaviorDefaults)})),i(e,t,!0),e.history.add("assign open behavior to all pages"))},assignOpenBehaviorToPage:function(e,t){const o=u.default(e),n=o.popupPointer.id,r=o.openBehaviors;if(p.default.isMasterPageSelected(e,r))return;if(a.default.has(o.disabledPageIds,t))return;const s=o.selectedPageIds.concat(t);s.length>1&&s.length===o.allPageIds.length?(g(e,r),f(e,e.dsRead.siteSegments.getSiteStructureId(),n,o.behaviorDefaults)):f(e,t,n,o.behaviorDefaults),d(e,o,!0,t),e.history.add("assign open behavior to page")},removeOpenBehaviorFromPage:function(e,t){const o=e.dsRead.pages.popupPages.getCurrentPopupId(),n=e.pages.popupPages.getOpenBehaviorsForPopupWithId(o),r=p.default.findMasterPageBehavior(e,n),s=u.default(e);r?function(e,t,o){const n=a.default.without(e.dsRead.pages.getPageIdList(),o);c(e,e.dsRead.siteSegments.getSiteStructureId(),t.popupId),n.forEach((function(o){f(e,o,t.popupId,t.params)}))}(e,r,t):c(e,t,o),d(e,s,!1,t),e.history.add("remove open behavior from page")},changeOpenDelay:function(e,t){const o=e.dsRead.pages.popupPages.getCurrentPopupId();e.pages.popupPages.getOpenBehaviorsForPopupWithId(o).forEach((function(o){f(e,o.pageId,o.popupId,a.default.defaults({delay:t},o.params))}))},toggleLoadOnMobile:function(e,t){const o=e.dsRead.pages.popupPages.getCurrentPopupId();e.pages.popupPages.getOpenBehaviorsForPopupWithId(o).forEach((function(o){f(e,o.pageId,o.popupId,a.default.defaults({openInMobile:t},o.params))})),e.history.add("toggle load on mobile")}}}.apply(t,n))||(e.exports=a)},2123:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(155)],void 0===(a=function(e,t,o,n,a){"use strict";return n=o.__importDefault(n),a=o.__importDefault(a),function(e){const t=e.pages.popupPages.getCurrentPopup(),o=e.pages.popupPages.getOpenBehaviorsForPopups(),u=n.default.filter(o,{popupId:t.id}),p=a.default.getDisabledPageIds(o,t.id,e),r=e.dsRead.pages.getPageIdList();return{allPageIds:r,behaviorDefaults:a.default.getSomeBehavior(u,e).params,disabledPageIds:n.default.zipObject(p),enabledPageIds:n.default.difference(r,p),openBehaviors:u,popupPointer:t,selectedPageIds:n.default.map(u,"pageId")}}}.apply(t,n))||(e.exports=a)},2124:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(2125),o(155)],void 0===(a=function(e,t,o,n,a,u){"use strict";return n=o.__importDefault(n),a=o.__importDefault(a),u=o.__importDefault(u),function(e){const t=e.pages.popupPages.getCurrentPopup(),o=e.pages.popupPages.getOpenBehaviorsForPopups(),p=n.default.filter(o,{popupId:t.id}),r=a.default.getCloseButtonsInfo(t,e);return{delay:u.default.getDelay(p,e),hasIconButton:r.has.icon,hasTextButton:r.has.text,isMasterPageSelected:u.default.isMasterPageSelected(e,p),selectedPageIds:n.default.map(p,"pageId")}}}.apply(t,n))||(e.exports=a)},2125:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(278)],void 0===(a=function(e,t,o,n,a){"use strict";n=o.__importDefault(n);const u=(a=o.__importDefault(a)).default;function p(e,t,o){const a=o.components.get.byType(e,t);return!n.default.isEmpty(a)}return{getCloseButtonsInfo:function(e,t){const o={};return o[u.ICON]=p(u.ICON_TYPE,e,t),o[u.TEXT]=p(u.TEXT_TYPE,e,t),{has:o}}}}.apply(t,n))||(e.exports=a)},2126:function(e,t,o){var n,a;n=[o,t,o(0),o(155)],void 0===(a=function(e,t,o,n){"use strict";return n=o.__importDefault(n),function(e){const t=n.default.getCurrentOpenBehaviors(e);return{shouldOpenInMobile:n.default.isOpenInMobile(t,e)}}}.apply(t,n))||(e.exports=a)},2127:function(e,t,o){var n,a;n=[o,t,o(0),o(1),o(155)],void 0===(a=function(e,t,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=o.__importDefault(n),a=o.__importDefault(a);const u=n.default.curry((function(e,t){const o=t[0].popupId;return e.pages.getPageTitle(o)}));t.getPageSelectorPanelProps=function(e){const t=e.pages.popupPages.getCurrentPopup(),o=e.dsRead.pages.getPageIdList(),p=a.default.getDenormalizedBehaviors(e,e.pages.popupPages.getOpenBehaviorsForPopups(),o),r=n.default.filter(p,{popupId:t.id}),s=n.default.reject(p,{popupId:t.id}),i=n.default(s).groupBy("pageId").mapValues(u(e)).value(),d=n.default.difference(o,n.default.keys(i)),l=n.default.map(r,"pageId");return{selectAll:{visible:o.length>1,disabled:0===d.length,indeterminate:(f=0,c=r.length,g=d.length,f<c&&c<g),checked:l.length>0&&l.length===d.length},selectedPageIds:l,occupiedPages:i};var f,c,g}}.apply(t,n))||(e.exports=a)},278:function(e,t,o){var n;void 0===(n=function(e,t){"use strict";return{ICON:"icon",ICON_TYPE:"wysiwyg.viewer.components.PopupCloseIconButton",TEXT:"text",TEXT_TYPE:"wysiwyg.viewer.components.PopupCloseTextButton"}}.apply(t,[o,t]))||(e.exports=n)},513:function(e,t,o){var n;void 0===(n=function(e,t){"use strict";return{DESKTOP:1,MOBILE:2,DESKTOP_AND_MOBILE:3,FLAG_DESKTOP:"openInDesktop",FLAG_MOBILE:"openInMobile",OPEN_DELAY_DEFAULT_VALUE:2,SITE_BEHAVIOR_TYPE:"site",LOAD_ACTION:"load",OPEN_POPUP_BEHAVIOR:"openPopup"}}.apply(t,[o,t]))||(e.exports=n)}})}));
//# sourceMappingURL=popups.min.js.map